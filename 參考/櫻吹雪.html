<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <title>櫻吹雪效果</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            overflow: hidden;
            background: linear-gradient(20deg, #def4ff, #FFF);
        }

        .sakura-container {
            position: fixed;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 1000;
        }

        .controls {
            position: fixed;
            top: 20px;
            left: 20px;
            background: rgba(255, 255, 255, 0.8);
            padding: 15px;
            border-radius: 5px;
            z-index: 1001;
        }

        .checkbox-container {
            margin: 10px 0;
        }

        label {
            display: inline-block;
            margin-right: 10px;
        }
    </style>
</head>

<body>
    <div class="controls">
        <div class="checkbox-container">
            <label>
                <input type="checkbox" id="enableEffect" checked>
                啟用效果
            </label>
        </div>
    </div>

    <div id="sakura-container" class="sakura-container"></div>

    <script>
        class SakuraFubuki {
            constructor(container, options = {}) {
                this.container = container;
                this.options = {
                    quantity: options.quantity || 500,
                    particleSize: options.particleSize || { width: 1.05, height: 1.5 },
                    velocity: options.velocity || { x: -0.35, y: -0.15, z: -0.1 }
                };

                this.particles = [];
                this.init();
            }

            init() {
                // 清空容器
                this.container.innerHTML = '';
                this.particles = [];

                // 創建櫻花粒子
                for (let i = 0; i < this.options.quantity; i++) {
                    this.createParticle();
                }

                // 開始動畫
                this.animate();
            }

            createParticle() {
                const particle = document.createElement('div');
                particle.style.cssText = `
                    position: absolute;
                    width: ${this.options.particleSize.width}rem;
                    height: ${this.options.particleSize.height}rem;
                    background: rgba(255, 218, 225, 0.8);
                    border-radius: 50%;
                    pointer-events: none;
                    transform: translate3d(0, 0, 0);
                `;

                // 隨機初始位置
                const x = Math.random() * window.innerWidth;
                const y = Math.random() * window.innerHeight;
                const z = Math.random() * 100;

                particle.dataset.x = x;
                particle.dataset.y = y;
                particle.dataset.z = z;

                this.container.appendChild(particle);
                this.particles.push(particle);
            }

            animate() {
                this.particles.forEach(particle => {
                    let x = parseFloat(particle.dataset.x);
                    let y = parseFloat(particle.dataset.y);
                    let z = parseFloat(particle.dataset.z);

                    // 更新位置
                    x += this.options.velocity.x * (z / 50);
                    y += this.options.velocity.y * (z / 50);
                    z += this.options.velocity.z;

                    // 檢查邊界
                    if (x < -100) x = window.innerWidth + 100;
                    if (y < -100) y = window.innerHeight + 100;
                    if (z < 0) z = 100;

                    particle.dataset.x = x;
                    particle.dataset.y = y;
                    particle.dataset.z = z;

                    // 更新視覺效果
                    particle.style.transform = `translate3d(${x}px, ${y}px, ${z}px) rotate(${x * 0.1}deg)`;
                    particle.style.opacity = Math.min(1, z / 50);
                });

                requestAnimationFrame(() => this.animate());
            }
        }

        // 初始化
        const container = document.getElementById('sakura-container');
        const effect = new SakuraFubuki(container);

        // 控制開關
        document.getElementById('enableEffect').addEventListener('change', function (e) {
            container.style.display = e.target.checked ? 'block' : 'none';
        });
    </script>
</body>

</html>