<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <style>
        .container {
            width: 100%;
            display: flex;
            flex-direction: column;
            gap: 1rem;
            padding: 1.5rem;
            border: 1px solid #d1d5db;
        }

        .control-panel {
            border: 1px solid #d1d5db;
            border-radius: 0.25rem;
            padding: 1rem;
        }

        .button-container {
            display: flex;
            justify-content: center;
            min-height: 200px;
            position: relative;
        }

        .naughty-button {
            padding: 0.5rem 1.5rem;
            background-color: #26A69A;
            color: white;
            border: none;
            border-radius: 999px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s ease;
            position: absolute;
        }

        .naughty-button:disabled {
            opacity: 0.7;
        }

        .rubbing {
            padding: 0.5rem 1.5rem;
            background: #FEFEFE;
            border-radius: 999px;
            border: 1px dashed #777;
            position: absolute;
            opacity: 0;
            pointer-events: none;
        }
    </style>
</head>

<body>
    <div class="container" style="width: 500px;">
        <div class="control-panel">
            <label>
                <input type="checkbox" id="disableButton" checked> 停用按鈕
            </label>
        </div>

        <div class="button-container">
            <button class="naughty-button" id="myButton" style="width: 100px;">調皮的按鈕</button>
            <div class="rubbing" id="rubbing">啪！跑了</div>
        </div>
    </div>

    <script>
        const button = document.getElementById('myButton');
        const disableCheckbox = document.getElementById('disableButton');
        const rubbing = document.getElementById('rubbing');
        let originalPosition = { x: 0, y: 0 };
        let isRunning = false;

        // 初始化按鈕位置
        function initButtonPosition() {
            const container = button.parentElement;
            originalPosition = {
                x: container.offsetWidth / 2 - button.offsetWidth / 2,
                y: container.offsetHeight / 2 - button.offsetHeight / 2
            };
            setButtonPosition(originalPosition.x, originalPosition.y);
        }

        // 設置按鈕位置
        function setButtonPosition(x, y) {
            button.style.transform = `translate(${x}px, ${y}px)`;
            rubbing.style.transform = `translate(${originalPosition.x}px, ${originalPosition.y}px)`;
        }

        // 計算逃跑方向
        function calculateEscapeDirection(mouseX, mouseY) {
            const rect = button.getBoundingClientRect();
            const buttonCenterX = rect.left + rect.width / 2;
            const buttonCenterY = rect.top + rect.height / 2;

            const dx = buttonCenterX - mouseX;
            const dy = buttonCenterY - mouseY;
            const distance = Math.sqrt(dx * dx + dy * dy);

            return {
                x: (dx / distance) * 100,
                y: (dy / distance) * 100
            };
        }

        // 監聽滑鼠移動
        button.addEventListener('mouseover', function (e) {
            if (button.disabled && !isRunning) {
                isRunning = true;
                const escape = calculateEscapeDirection(e.clientX, e.clientY);
                const newX = originalPosition.x + escape.x;
                const newY = originalPosition.y + escape.y;

                setButtonPosition(newX, newY);
                rubbing.style.opacity = '1';

                setTimeout(() => {
                    setButtonPosition(originalPosition.x, originalPosition.y);
                    rubbing.style.opacity = '0';
                    isRunning = false;
                }, 1000);
            }
        });

        // 監聽停用狀態變化
        disableCheckbox.addEventListener('change', function () {
            button.disabled = this.checked;
            if (!this.checked) {
                setButtonPosition(originalPosition.x, originalPosition.y);
                rubbing.style.opacity = '0';
            }
        });

        // 初始化
        window.addEventListener('load', initButtonPosition);
        window.addEventListener('resize', initButtonPosition);
        button.disabled = disableCheckbox.checked;
    </script>
</body>

</html>